# TOML é…ç½®è§£æä¼˜åŒ–æ€»ç»“

## ğŸ¯ ä¼˜åŒ–ç›®æ ‡
ä¼˜åŒ– `ClientConfigManager::parseFullTomlConfig` æ–¹æ³•ï¼Œä½¿ç”¨æŠ½è±¡å·¥å…·å‡½æ•°å’Œæ˜ å°„è¡¨æ¥å‡å°‘é‡å¤ä»£ç ï¼Œæé«˜ä»£ç å¯ç»´æŠ¤æ€§å’Œå¯è¯»æ€§ã€‚

## ğŸ”§ ä¼˜åŒ–å®æ–½

### 1. æŠ½è±¡å·¥å…·å‡½æ•°è®¾è®¡

#### é€šç”¨é…ç½®è§£æå‡½æ•°
```cpp
template<typename T>
void parseConfigValue(const toml::value& section, const std::string& key, T& target);
```
- **åŠŸèƒ½**: æ”¯æŒæ‰€æœ‰åŸºç¡€æ•°æ®ç±»å‹çš„ç»Ÿä¸€è§£æ
- **æ”¯æŒç±»å‹**: `std::string`, `bool`, `int`, `uint16_t`, `uint32_t`, `uint64_t`
- **é”™è¯¯å¤„ç†**: å†…ç½®å¼‚å¸¸æ•è·å’Œæ—¥å¿—è®°å½•
- **TOMLå…¼å®¹**: ä½¿ç”¨ `.at()` æ–¹æ³•ç¡®ä¿å¸¸é‡å®‰å…¨æ€§

#### æšä¸¾ç±»å‹è§£æå‡½æ•°
```cpp
template<typename EnumType>
void parseEnumValue(const toml::value& section, const std::string& key, EnumType& target);
```
- **åŠŸèƒ½**: ä¸“é—¨å¤„ç†æšä¸¾ç±»å‹çš„å­—ç¬¦ä¸²è½¬æ¢
- **æ”¯æŒæšä¸¾**: `CompressionAlgorithm`, `ChecksumAlgorithm`
- **è½¬æ¢æœºåˆ¶**: é›†æˆ `EnumConvert.hpp` çš„è½¬æ¢å‡½æ•°

#### å­—ç¬¦ä¸²æ•°ç»„è§£æå‡½æ•°
```cpp
void parseStringArray(const toml::value& section, const std::string& key, std::vector<std::string>& target);
```
- **åŠŸèƒ½**: å¤„ç† TOML æ•°ç»„ç±»å‹åˆ° `std::vector<std::string>` çš„è½¬æ¢
- **å®‰å…¨æ£€æŸ¥**: éªŒè¯ TOML å€¼æ˜¯å¦ä¸ºæ•°ç»„ç±»å‹

### 2. æ¨¡å—åŒ–é…ç½®è§£æ

#### åˆ†ç¦»é…ç½®èŠ‚è§£æ
- `parseUploadConfigSection()` - å¤„ç† `[upload]` èŠ‚çš„æ‰€æœ‰é…ç½®é¡¹
- `parseUIConfigSection()` - å¤„ç† `[ui]` èŠ‚çš„æ‰€æœ‰é…ç½®é¡¹  
- `parseNetworkConfigSection()` - å¤„ç† `[network]` èŠ‚çš„æ‰€æœ‰é…ç½®é¡¹

#### ç®€åŒ–ä¸»è§£æå‡½æ•°
```cpp
bool parseFullTomlConfig(const std::string& tomlContent) {
    try {
        auto data = toml::parse_str(tomlContent);
        
        parseUploadConfigSection(data);
        parseUIConfigSection(data);
        parseNetworkConfigSection(data);
        
        return true;
    } catch (const std::exception& e) {
        // é”™è¯¯å¤„ç†
        return false;
    }
}
```

### 3. ä»£ç é‡å¤å‡å°‘æ•ˆæœ

#### ä¼˜åŒ–å‰ (åŸå§‹ä»£ç )
- **æ€»è¡Œæ•°**: ~200+ è¡Œ
- **é‡å¤æ¨¡å¼**: æ¯ä¸ªé…ç½®é¡¹éƒ½æœ‰ç‹¬ç«‹çš„ `if (section.contains(key))` æ£€æŸ¥
- **ç±»å‹è½¬æ¢**: æ¯ä¸ªé…ç½®é¡¹éƒ½æœ‰é‡å¤çš„ç±»å‹è½¬æ¢ä»£ç 
- **é”™è¯¯å¤„ç†**: åˆ†æ•£åœ¨å„ä¸ªè§£æç‚¹

#### ä¼˜åŒ–å (æ–°ä»£ç )
- **æ€»è¡Œæ•°**: ~120 è¡Œ
- **é‡å¤æ¶ˆé™¤**: ä½¿ç”¨ç»Ÿä¸€çš„ `parseConfigValue()` å‡½æ•°
- **ç±»å‹å®‰å…¨**: æ¨¡æ¿è‡ªåŠ¨æ¨å¯¼ç±»å‹è½¬æ¢
- **ç»Ÿä¸€é”™è¯¯å¤„ç†**: é›†ä¸­åœ¨å·¥å…·å‡½æ•°ä¸­

### 4. å…·ä½“ä¼˜åŒ–ç¤ºä¾‹

#### ä¼˜åŒ–å‰çš„é‡å¤ä»£ç æ¨¡å¼
```cpp
// æ¯ä¸ªé…ç½®é¡¹éƒ½é‡å¤è¿™ç§æ¨¡å¼
if (upload.contains("server_host")) {
    m_uploadConfig.serverHost = upload["server_host"].as_string();
}
if (upload.contains("server_port")) {
    m_uploadConfig.serverPort = static_cast<uint16_t>(upload["server_port"].as_integer());
}
if (upload.contains("enable_resume")) {
    m_uploadConfig.enableResume = upload["enable_resume"].as_boolean();
}
```

#### ä¼˜åŒ–åçš„ç®€æ´ä»£ç 
```cpp
// ä½¿ç”¨ç»Ÿä¸€çš„å·¥å…·å‡½æ•°ï¼Œä¸€è¡Œæå®š
parseConfigValue(upload, "server_host", m_uploadConfig.serverHost);
parseConfigValue(upload, "server_port", m_uploadConfig.serverPort);
parseConfigValue(upload, "enable_resume", m_uploadConfig.enableResume);
```

## âœ… ä¼˜åŒ–æˆæœ

### ä»£ç è´¨é‡æå‡
- **å¯è¯»æ€§**: é…ç½®è§£æé€»è¾‘æ›´æ¸…æ™°ï¼Œä¸€ç›®äº†ç„¶
- **å¯ç»´æŠ¤æ€§**: æ–°å¢é…ç½®é¡¹åªéœ€ä¸€è¡Œä»£ç 
- **ç±»å‹å®‰å…¨**: ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯
- **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

### æ€§èƒ½ä¼˜åŒ–
- **ç¼–è¯‘ä¼˜åŒ–**: æ¨¡æ¿å‡½æ•°åœ¨ç¼–è¯‘æ—¶å±•å¼€ï¼Œæ— è¿è¡Œæ—¶å¼€é”€
- **å†…å­˜æ•ˆç‡**: å‡å°‘äº†é‡å¤çš„å­—ç¬¦ä¸²åˆ›å»ºå’Œæ¯”è¾ƒ
- **å¼‚å¸¸å®‰å…¨**: ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†æœºåˆ¶

### æ‰©å±•æ€§å¢å¼º
- **æ–°é…ç½®æ”¯æŒ**: æ·»åŠ æ–°é…ç½®é¡¹åªéœ€è°ƒç”¨å¯¹åº”çš„å·¥å…·å‡½æ•°
- **æ–°ç±»å‹æ”¯æŒ**: å¯ä»¥è½»æ¾æ‰©å±•æ”¯æŒæ–°çš„æ•°æ®ç±»å‹
- **æ–°æšä¸¾æ”¯æŒ**: é€šè¿‡æ¨¡æ¿ç‰¹åŒ–æ”¯æŒæ–°çš„æšä¸¾ç±»å‹

## ğŸ”® æœªæ¥å¯æ‰©å±•æ€§

1. **æ–°æ•°æ®ç±»å‹æ”¯æŒ**: å¯é€šè¿‡æ¨¡æ¿ç‰¹åŒ–è½»æ¾æ·»åŠ æ–°ç±»å‹
2. **é…ç½®éªŒè¯**: å¯åœ¨å·¥å…·å‡½æ•°ä¸­æ·»åŠ å€¼èŒƒå›´éªŒè¯
3. **é»˜è®¤å€¼å¤„ç†**: å¯æ‰©å±•æ”¯æŒé…ç½®é¡¹çš„é»˜è®¤å€¼æœºåˆ¶
4. **é…ç½®çƒ­æ›´æ–°**: åŸºäºç»Ÿä¸€æ¥å£çš„é…ç½®åŠ¨æ€æ›´æ–°

## ğŸ“Š ä»£ç è¡Œæ•°å¯¹æ¯”
- **ä¼˜åŒ–å‰**: çº¦ 200+ è¡Œé‡å¤ä»£ç 
- **ä¼˜åŒ–å**: çº¦ 120 è¡Œç²¾ç®€ä»£ç 
- **å‡å°‘å¹…åº¦**: ~40% çš„ä»£ç é‡å‡å°‘
- **ç»´æŠ¤æˆæœ¬**: å¤§å¹…é™ä½ï¼Œæ–°å¢é…ç½®åªéœ€ä¸€è¡Œ

è¿™æ¬¡ä¼˜åŒ–ä¸ä»…å‡å°‘äº†é‡å¤ä»£ç ï¼Œè¿˜æé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§ã€ç±»å‹å®‰å…¨æ€§å’Œæ‰©å±•æ€§ï¼Œä¸ºæœªæ¥çš„åŠŸèƒ½æ‰©å±•å¥ å®šäº†è‰¯å¥½çš„åŸºç¡€ã€‚